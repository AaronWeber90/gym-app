import{f as x,t as c,i,h as d,S as $,F,l as _}from"./index-lFaSI7kj.js";var D=c('<svg xmlns=http://www.w3.org/2000/svg fill=none viewBox="0 0 24 24"stroke-width=1.5 stroke=currentColor class="h-4 w-4"><path stroke-linecap=round stroke-linejoin=round d="M2.25 12.75V12A2.25 2.25 0 014.5 9.75h15A2.25 2.25 0 0121.75 12v.75m-8.69-6.44l-2.12-2.12a1.5 1.5 0 00-1.061-.44H4.5A2.25 2.25 0 002.25 6v12a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9a2.25 2.25 0 00-2.25-2.25h-5.379a1.5 1.5 0 01-1.06-.44z"></path><title>folder-open-icon'),b=c('<svg xmlns=http://www.w3.org/2000/svg fill=none viewBox="0 0 24 24"stroke-width=1.5 stroke=currentColor class="h-4 w-4"><path stroke-linecap=round stroke-linejoin=round d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"></path><title>file-icon'),j=c('<ul class="menu menu-xs bg-base-200 rounded-box max-w-xs w-full">'),k=c('<div class=p-6><div class="flex justify-between items-center mb-4"><h1 class="text-2xl font-bold">ğŸ—‚ï¸ OPFS File Explorer</h1><button class="btn btn-error btn-sm"type=button>Delete All Data'),C=c("<p>No entries found."),N=c('<details open><summary class="flex items-center gap-1"> </summary><ul>'),S=c("<li>"),A=c("<a> ");async function w(a,n=""){const s=[],t=new Set;for await(const[e,r]of a.entries()){const l=n?`${n}/${e}`:e;if(r.kind==="directory"){let o=e,u=!1;try{const p=`${e}.json`,y=await(await(await a.getFileHandle(p)).getFile()).text(),m=JSON.parse(y);m?.name&&(o=m.name),t.add(e)}catch{}await a.getFileHandle(`${e}.json`).then(()=>!0).catch(()=>!1)&&!t.has(e)&&(u=!0),u||s.push({type:"folder",name:e,displayName:o,path:l,children:await w(r,l)})}else{let o=e,u="";try{if(e.endsWith(".json")){const p=await(await r.getFile()).text(),h=JSON.parse(p),f=e.replace(".json","");if(await a.getDirectoryHandle(f).then(()=>!0).catch(()=>!1)){const m=await a.getDirectoryHandle(f);s.push({type:"folder",name:f,displayName:h?.name||f,path:l.replace(".json",""),children:await w(m,l.replace(".json",""))});continue}h?.name&&(o=h.name),h?.date&&(u=` (${new Intl.DateTimeFormat("de-DE").format(new Date(h.date))})`)}}catch{}s.push({type:"file",name:e,displayName:o+u,path:l})}}return s}async function E(){try{const a=await navigator.storage.getDirectory();return await w(a)}catch(a){return console.error("Failed to read OPFS:",a),[]}}const O=()=>D(),H=()=>b(),P=()=>{const[a,{refetch:n}]=x(E),s=async()=>{if(confirm("Are you sure you want to delete ALL data? This action cannot be undone."))try{const e=await navigator.storage.getDirectory();for await(const[r,l]of e.entries())try{l.kind==="directory"?await e.removeEntry(r,{recursive:!0}):await e.removeEntry(r),console.log(`Deleted: ${r}`)}catch(o){console.error(`Failed to delete ${r}:`,o)}n(),alert("All data has been deleted successfully.")}catch(e){console.error("Failed to delete OPFS data:",e),alert("Failed to delete data. Check console for details.")}};return(()=>{var t=k(),e=t.firstChild,r=e.firstChild,l=r.nextSibling;return l.$$click=s,i(t,d($,{get when(){return a()},get fallback(){return C()},get children(){var o=j();return i(o,d(v,{get entries(){return a()}})),o}}),null),t})()},v=a=>d(F,{get each(){return a.entries},children:n=>(()=>{var s=S();return i(s,d($,{get when(){return n.type==="folder"},get fallback(){return(()=>{var t=A(),e=t.firstChild;return i(t,d(H,{}),e),i(t,()=>n.displayName??n.name,null),t})()},get children(){var t=N(),e=t.firstChild,r=e.firstChild,l=e.nextSibling;return i(e,d(O,{}),r),i(e,()=>n.displayName??n.name,null),i(l,d(v,{get entries(){return n.children}})),t}})),s})()});_(["click"]);export{P as default};
