import{f as u}from"./index-pxAl_I5N.js";const d=async(e,o)=>{try{const n=await o.getDirectoryHandle(e,{create:!1});let s=null;for await(const[r,t]of n.entries())if(t.kind==="file"&&r.endsWith(".json"))try{const c=await(await t.getFile()).text(),i=JSON.parse(c),l=new Date(i.date||i.created_at);(!s||l>s)&&(s=l)}catch(a){console.warn("Failed to read child workout:",a)}return s?.toISOString()??null}catch{return null}},w=async(e,o,n)=>{const r=await(await o.getFile()).text(),t=JSON.parse(r),a=t.id??e.replace(".json",""),c=await d(a,n);return{id:a,name:t.name??"Unbenanntes Workout",created_at:t.created_at??new Date().toISOString(),lastTrainedAt:c}},f=async()=>{try{const o=await(await navigator.storage.getDirectory()).getDirectoryHandle("workouts",{create:!0}),n=[];for await(const[r,t]of o.entries())if(t.kind==="file"&&r.endsWith(".json")){const c=await w(r,t,o);n.push(c)}return n.sort((r,t)=>{const a=new Date(r.created_at).getTime();return new Date(t.created_at).getTime()-a})}catch(e){return console.error("Failed to read workouts from OPFS:",e),[]}},D=()=>{const[e,{refetch:o}]=u(f);return{workouts:e,refetch:o}};export{D as c};
